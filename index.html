<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Video</title>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
</head>


<!-- 
MAIN
https://youtu.be/9fPl7yYqBts

A
Project Atum
https://youtu.be/yOCxZRbwipE

B
Project Thoth
https://youtu.be/g2qxPuPoV5c

AA
智慧醫療<br>Smart Healthcare
https://youtu.be/tnPscr4MZb4

AB
智慧運輸<br>Smart Mobility
https://youtu.be/zQa9lrEor1g

BA
智慧育樂<br>Future Entertainment<br>Technology
https://youtu.be/FghZx1o4ePE

BB
智慧檢測<br>Smart Monitoring<br>Technology
https://youtu.be/FcqhOOE3X8A
 -->
<style>
	.box{
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;		
	}
	.btn-group {
		z-index: 99;
    position:absolute; 
    top:0;
    top:80%;
    width:100%;
	}





  /* @media (max-width: 640px){
      .btn-group {
          max-width: 900px;
          position:absolute;
          top:50%; 
          left:50%;
          z-index: 99;
      }
  } */
</style>

<body>



  <div class="box bg-black">
   
    <div  class="relative">
      <div class="video-wrapper">
        <div id="MAIN"></div> 
      </div>
           
      <div class="btn-group flex items-center justify-center">
        <button OnClick="clickA()" class="hover:bg-red-400 bg-opacity-75 border-2 border-white rounded-xl  px-6 py-2 md:px-10 md:py-4 bg-gray-400 z-10 text-white font-bold text-xl transparent" id="btnA" style="display:none;">Project Atum</button>
        <button OnClick="clickB()" class="hover:bg-red-400 bg-opacity-75 border-2 border-white rounded-xl  px-6 py-2 md:px-10 md:py-4 bg-gray-400 z-10 text-white font-bold text-xl transparent" id="btnB" style="display:none;">Project Thoth</button>
      </div>

    </div>


    <div class="relative">
      <div id="containerA" style="display:none;"></div>
      <div id="containerB" style="display:none;"></div>
      <div class="btn-group flex items-center justify-center">
        <button OnClick="clickAA()" class="hover:bg-red-400 bg-opacity-75 border-2 border-white rounded-xl  px-6 py-2 md:px-10 md:py-4 bg-gray-400 z-10 text-white font-bold text-xl transparent" id="btnAA" style="display:none;">智慧醫療<br>Smart Healthcare</button>
        <button OnClick="clickAB()" class="hover:bg-red-400 bg-opacity-75 border-2 border-white rounded-xl  px-6 py-2 md:px-10 md:py-4 bg-gray-400 z-10 text-white font-bold text-xl transparent" id="btnAB" style="display:none;">智慧運輸<br>Smart Mobility</button>
      </div>
      <div class="btn-group flex items-center justify-center">
        <button OnClick="clickBA()" class="hover:bg-red-400 bg-opacity-75 border-2 border-white rounded-xl px-6 py-2 md:px-10 md:py-4 bg-gray-400 z-10 text-white font-bold text-xl transparent" id="btnBA" style="display:none;">智慧育樂<br>Future Entertainment<br>Technology</button>
        <button OnClick="clickBB()" class="hover:bg-red-400 bg-opacity-75 border-2 border-white rounded-xl px-6 py-2 md:px-10 md:py-4 bg-gray-400 z-10 text-white font-bold text-xl transparent" id="btnBB" style="display:none;">智慧檢測<br>Smart Monitoring<br>Technology</button>
      </div>
    </div>


    <div class="relative">
      <div id="containerAA" style="display:none;"></div>
      <div id="containerAB" style="display:none;"></div>

    </div>

    <div class="relative">
      <div id="containerBA" style="display:none;"></div>
      <div id="containerBB" style="display:none;"></div>

    </div>
  </div>

    <script>

		const containerA = document.getElementById('containerA');
		const containerB = document.getElementById('containerB');
		const containerAA = document.getElementById('containerAA');
		const containerAB = document.getElementById('containerAB');
		const containerBA = document.getElementById('containerBA');
		const containerBB = document.getElementById('containerBB');
		
  	const btnA = document.getElementById('btnA');
		const btnB = document.getElementById('btnB');
  	const btnAA = document.getElementById('btnAA');
		const btnAB = document.getElementById('btnAB');		
		const btnBA = document.getElementById('btnBA');
		const btnBB = document.getElementById('btnBB');

    var main_video;
    var a_video;
    var b_video;
    var aa_video;
    var ab_video;
    var ba_video;
    var bb_video;


    var clickedA = false;
    var clickedB = false;
    var clickedAA = false;
    var clickedAB = false;
    var clickedBA = false;
    var clickedBB = false;


      var done = false;

      var tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      function onYouTubeIframeAPIReady() {
        var controlsValue = 1; // 0 = no controls

        main_video = new YT.Player('MAIN', {
          height: $(window).height(),
          width: $(window).width(),
          videoId:'1TMY_-9oCDk',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange_m,
          },
          playerVars: {
            'playsinline': 1,
            'controls': controlsValue,

          },
        });

        a_video = new YT.Player('containerA', {
          height: $(window).height(),
          width: $(window).width(),
          videoId:'_s2dt2QZD_o',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange_a
          },
          playerVars: {
             'playsinline': 1,
             'controls': controlsValue,
          }
        });

        b_video = new YT.Player('containerB', {
          height: $(window).height(),
          width: $(window).width(),
          videoId:'4x5a1qOg0uU',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange_b,
          },
          playerVars: {
             'playsinline': 1,
              'controls': controlsValue,
          }
        });

        aa_video = new YT.Player('containerAA', {
          height: $(window).height(),
          width: $(window).width(),
          videoId:'CqXA6HoIf4I',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange_other
          },
          playerVars: {
             'playsinline': 1,
             'controls': controlsValue,
          }
        });

        ab_video = new YT.Player('containerAB', {
          height: $(window).height(),
          width: $(window).width(),
          videoId:'4iphST-Ff6k',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange_other
          },
          playerVars: {
             'playsinline': 1,
             'controls': controlsValue,
          }
        });

        ba_video = new YT.Player('containerBA', {
          height: $(window).height(),
          width: $(window).width(),
          videoId:'vK3SPRU8AeQ',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange_other
          },
          playerVars: {
             'playsinline': 1,
             'controls': controlsValue,
          }
        });

        bb_video = new YT.Player('containerBB', {
          height: $(window).height(),
          width: $(window).width(),
          videoId:'4oZsfBEuTYo',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange_other
          },
          playerVars: {
             'playsinline': 1,
             'controls': controlsValue,
          }
        });
  
      }


      function onPlayerReady(event) {
        // event.target.playVideo();
      }

      function startInterval( player, btn1, bnt2 ) {
        checkInt = setInterval(function() {
          console.log("startInterval")
          console.log(player.getCurrentTime())
            if (player.getCurrentTime() >= player.getDuration()-12 && player.getCurrentTime() < player.getDuration()-1 && !clickedA && !clickedB) {
              showBtn( btn1, bnt2 );
              clearInterval(checkInt);
            };
        }, 1000)
      }

      function startInterval2( player, btn1, bnt2 ) {
        checkInt = setInterval(function() {
          console.log("startInterval2")
          console.log(player.getCurrentTime())
            if (player.getCurrentTime() >= player.getDuration()-8 && player.getCurrentTime() < player.getDuration()-1 && !clickedAA && !clickedAB ) {
              showBtn( btn1, bnt2 );
              clearInterval(checkInt);
            };
        }, 1000)
      }

      function startInterval3( player, btn1, bnt2 ) {
        checkInt = setInterval(function() {
          console.log("startInterval3")
          console.log(player.getCurrentTime())
            if (player.getCurrentTime() >= player.getDuration()-8 && player.getCurrentTime() < player.getDuration()-1 && !clickedBA && !clickedBB) {
              showBtn( btn1, bnt2 );
              clearInterval(checkInt);
            };
        }, 1000)
      }      

      function resize( e ){
        $( window ).resize(function() {
           e.target.setSize( $(window).width() , $(window).height() );
        });
      }

// onPlayerStateChange ============================================
      function onPlayerStateChange_m(event) {
        if (event.data == YT.PlayerState.PLAYING ) {
          startInterval( event.target, btnA, btnB );
          resize( event );
        }

        if (event.data == YT.PlayerState.ENDED) {
          hideBtn( btnA, btnB );
          hideContainer( window.MAIN );
          showContainer( window.containerA );
          a_video.playVideo();
        }
      }

      function onPlayerStateChange_a(event) {
        if (event.data == YT.PlayerState.PLAYING ) {
          startInterval2( event.target, btnAA, btnAB  );
          // resize( event );
        }

        if (event.data == YT.PlayerState.ENDED) {
          hideBtn( btnAA, btnAB );
          hideContainer( window.containerA );
          showContainer( window.containerAA );
          aa_video.playVideo();
          
        }
      }

      function onPlayerStateChange_b(event) {
        if (event.data == YT.PlayerState.PLAYING ) {
          startInterval3( event.target, btnBA, btnBB );
          // resize( event );
        }

        if (event.data == YT.PlayerState.ENDED) {
          hideBtn( btnBA, btnBB );
          hideContainer( window.containerB );
          showContainer( window.containerBA );
          ba_video.playVideo();
   
        }
      }

      function onPlayerStateChange_other () {
        if (event.data == YT.PlayerState.PLAYING ) {
          // resize( event );
        }
      }

// function============================================
      function showBtn(btn1, btn2) {
				btn1.style.display = "block";
				btn2.style.display = "block";
        // done = true;
      }
      function hideBtn(btn1, btn2) {
        btn1.style.display = "none";
        btn2.style.display = "none";
        // done = false;
      }
      function showContainer(container) {
        container.style.display = "block"
      }
      function hideContainer(container) {
        container.style.display = "none";
      }




// click============================================
      function clickA(){
          hideBtn( btnA, btnB );
          main_video.destroy();
          main_video.setInterval   
          hideContainer( window.MAIN );
          showContainer( window.containerA );
          a_video.playVideo();
          clickedA = true;
          clickedB = true;
      }
      function clickB(){
          hideBtn( btnA, btnB );
          main_video.destroy();  
          hideContainer( window.MAIN );
          showContainer( window.containerB );
          b_video.playVideo();
          clickedA = true;
          clickedB = true;
      }
      function clickAA(){
          hideBtn( btnAA, btnAB );
          a_video.destroy();  
          hideContainer( window.containerA );
          showContainer( window.containerAA );
          aa_video.playVideo();
          clickedAA = true;
          clickedAB = true;
      }
      function clickAB(){
          hideBtn( btnAA, btnAB );
          a_video.destroy();  
          hideContainer( window.containerA );
          showContainer( window.containerAB );
          ab_video.playVideo();
          clickedAA = true;
          clickedAB = true;
      }
      function clickBA(){
          hideBtn( btnBA, btnBB );
          b_video.destroy();    
          hideContainer( window.containerB );
          showContainer( window.containerBA );
          ba_video.playVideo();
          clickedBA = true;
          clickedBB = true;
      }
      function clickBB(){
          hideBtn( btnBA, btnBB );
          b_video.destroy();
          hideContainer( window.containerB );
          showContainer( window.containerBB );
          bb_video.playVideo(); 
          clickedBA = true;
          clickedBB = true;  
      }


  window.onresize = function(){ location.reload(); }
</script>



<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style=" z-index:1000000050;">

  <div class="modal-dialog" style="top:30%; ">
    <div class="modal-content">
      
      <div class="modal-body" align="center"><br>
        Oops! To ensure best viewing experience, please copy link and open in your browser to start the challenge.<br><br>
      </div>
      <div class="modal-footer" align="center">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close
        </button>
        
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal -->
</div>

<script>
  function isWebview() {
    var useragent = navigator.userAgent;
    var rules = ['WebView','(iPhone|iPod|iPad)(?!.*Safari\/)','Android.*(wv|\.0\.0\.0)'];
    var regex = new RegExp(`(${rules.join('|')})`, 'ig');
    return Boolean(useragent.match(regex));
}

var iOS = !!navigator.platform && /iPad|iPhone|iPod/.test(navigator.platform);

if(isWebview()) {

    $("#myModal").modal("show");

    if(iOS) {
       window.location = "googlechrome://"+location.host+location.pathname;

    } else if(/Micro/.test(navigator.userAgent)) {
     window.location = "intent://"+window.location.href.split("//")[1]+"#Intent;scheme=https;action=android.intent.action.VIEW;end;";
    }
    else {
      window.location = "intent://"+window.location.href.split("//")[1]+"#Intent;scheme=https;action=android.intent.action.VIEW;end;";
    }				
}


</script>

</body>
</html>
